# Постановка задачи

Пусть дана смесь из $n$ компонентов с мольным составом $\boldsymbol{N} = [N_1, \ldots, N_n]^\top$ при температуре $T$ и давлении $P$. Необходимо определить, является ли однофазное состояние смеси термодинамически стабильным.

## Критерий стабильности

Идея решения задачи заключается в сравнении энергий двух систем

- однофазная (исходная) система;
- двухфазная система, где вторая фаза представлена в малом количестве.

Также можно сказать, что мы попытаемся найти флуктуацию (состава и плотности), приводящую систему к двухфазному состоянию, имеющему энергию меньше, чем у однофазной системы. В этом случае однофазное состояние нестабильно. Если же такой флуктуации не существует, то однофазное состояние термодинамически стабильно.

Рассмотрим собственный потенциал NPT системы -- свободную энергию Гиббса[^gibbs_derivation]

```{math}
G = G(\boldsymbol{N}, P, T) = \sum_i N_i \mu_i(\boldsymbol{N}, P, T).
```

В дальнейшем зависимость от давления $P$ и температуры $T$ писать не будем -- это параметры задачи.

[^gibbs_derivation]: Выражение свободной энергии Гиббса для смеси следует из аддитивности внутренней энергии и энтропии. Подробнее об этом в {cite}`Brusilovsky2002` (Раздел 2.9, Химический потенциал).

Теперь предположим, что часть вещества $\boldsymbol{\varepsilon}$ исходной системы образует вторую фазу. Тогда разница энергий двухфазного и однофазного состояний будет
```{math}
:label: ptstab_gibbs_delta

\Delta G = G(\boldsymbol{N} - \boldsymbol{\varepsilon}) + G(\boldsymbol{\varepsilon}) - G(\boldsymbol{N})
```

Если получится найти такое количество вещества $\boldsymbol{\varepsilon}$, что $\Delta G < 0$, то двухфазное состояние имеет меньшую энергию, а однофазное состояние -- нестабильно. Для этого, можно, например, найти глобальный минимум $\Delta G$ и посмотреть его знак. Однако, распространён следующий метод.

Будем считать, что общее количество вещества во второй фазе $\|\boldsymbol{\varepsilon}\|$ мало (вторая фаза в зародышевом состоянии, например). Разложим тогда в ряд Тейлора первое слагаемое из уравнения {eq}`ptstab_gibbs_delta`
```{math}
G(\boldsymbol{N} - \boldsymbol{\varepsilon}) \approx G(\boldsymbol{N}) - \sum_i \varepsilon_i \frac{\partial G}{\partial N_i} (\boldsymbol{N})
= G(\boldsymbol{N}) - \sum_i \varepsilon_i \mu_i(\boldsymbol{N}).
```

С учётом разложения, получаем[^gibbs_delta_approx]
```{math}
\Delta G = \sum_i \varepsilon_i \mu_i(\boldsymbol{\varepsilon}) - \sum_i \varepsilon_i \mu_i(\boldsymbol{N})
= \sum_i \varepsilon_i (\mu_i(\boldsymbol{\varepsilon}) - \mu_i(\boldsymbol{N})).
```

[^gibbs_delta_approx]: Строго говоря, это равенство выполняется приближённо. Знак точного равенства поставлен с целью упрощения изложения и математической записи.

Избавимся от абсолютных величин, введя общее количество вещества в фазе-зародыше $\varepsilon = \sum_i \varepsilon_i$
```{math}
:label: ptstab_gibbs_delta_relative

\Delta G = \varepsilon \sum_i x_i (\mu_i(\boldsymbol{x}) - \mu^0_i),
```
здесь $\boldsymbol{x} \equiv \boldsymbol{\varepsilon} / \varepsilon$ -- мольный состав фазы-зародыша, а $\mu^0_i$ -- химпотенциал компонентна в однофазном состоянии.

Поскольку в {eq}`ptstab_gibbs_delta_relative` $\varepsilon > 0$, получаем критерий стабильности фазы
```{math}
:label: ptstab_tpd

F(\boldsymbol{x}) = \sum_i x_i (\mu_i(\boldsymbol{x}) - \mu^0_i) \ge 0.
```
